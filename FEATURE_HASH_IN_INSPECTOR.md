# ‚ú® –ù–æ–≤–∞ —Ñ—ñ—á–∞: Hash –≤ Inspector –¥—ñ–∞–ª–æ–∑—ñ

## üìã –û–ø–∏—Å

–¢–µ–ø–µ—Ä –ø—Ä–∏ —ñ–Ω—Å–ø–µ–∫—Ç—É–≤–∞–Ω–Ω—ñ LoRA, Checkpoint —Ç–∞ —ñ–Ω—à–∏—Ö –º–æ–¥–µ–ª–µ–π —É –¥—ñ–∞–ª–æ–∑—ñ **Inspector** –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è **hash –º–æ–¥–µ—Ä–ª—è**, —â–æ –¥–æ–ø–æ–º–∞–≥–∞—î –ª–µ–≥—à–µ –∑–Ω–∞–π—Ç–∏ —Ç–∞ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –º–æ–¥–µ–ª—ñ.

## üéØ –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

### –†–∞–Ω—ñ—à–µ:
```
Inspector –¥–ª—è "my_model.safetensors"
‚îú‚îÄ‚îÄ civitai_model_id: 123456
‚îú‚îÄ‚îÄ civitai_version_id: 789012
‚îî‚îÄ‚îÄ description: "My awesome model"
```

### –¢–µ–ø–µ—Ä:
```
Inspector –¥–ª—è "my_model.safetensors"
‚îú‚îÄ‚îÄ civitai_model_id: 123456
‚îú‚îÄ‚îÄ civitai_version_id: 789012
‚îú‚îÄ‚îÄ description: "My awesome model"
‚îú‚îÄ‚îÄ hash: "abc123def456..."        ‚Üê –î–û–î–ê–ù–û
‚îî‚îÄ‚îÄ hash_type: "AUTOV2"             ‚Üê –î–û–î–ê–ù–û
```

## üîß –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### –§–∞–π–ª: `storage.py`

**1. –î–æ–¥–∞–Ω–æ —ñ–º–ø–æ—Ä—Ç** (—Ä—è–¥–æ–∫ 11):
```python
import model_metadata
```

**2. –û–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è `get_metadata()` (—Ä—è–¥–∫–∏ 303-330)**:

```python
def get_metadata(self, name):
    file = None
    for comp in self.files:
        if name in self.files[comp]:
            file = self.files[comp][name]
            break
    
    if not file:
        raise ValueError(f"unknown model: {name}")

    metadata = {}
    try:
        with safetensors.safe_open(file, framework="pt", device="cpu") as f:
            metadata = f.metadata() or {}
    except:
        pass

    # Add hash information from model_metadata if available
    try:
        mm = model_metadata.get_manager()
        file_metadata = mm.load_metadata(file)
        if file_metadata and "hash" in file_metadata:
            metadata["hash"] = file_metadata["hash"]
            if "hash_type" in file_metadata:
                metadata["hash_type"] = file_metadata["hash_type"]
    except:
        pass

    return metadata
```

## üìä –î–µ—Ç–∞–ª—ñ

### –î–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö

| –î–∞–Ω—ñ | –î–∂–µ—Ä–µ–ª–æ |
|------|---------|
| **civitai_model_id** | –ú–µ—Ç–∞–¥–∞–Ω—ñ –≤ .safetensors —Ñ–∞–π–ª—ñ |
| **civitai_version_id** | –ú–µ—Ç–∞–¥–∞–Ω—ñ –≤ .safetensors —Ñ–∞–π–ª—ñ |
| **description** | –ú–µ—Ç–∞–¥–∞–Ω—ñ –≤ .safetensors —Ñ–∞–π–ª—ñ |
| **hash** | `model_file.safetensors.metadata.json` ‚Üê **–î–û–î–ê–ù–û** |
| **hash_type** | `model_file.safetensors.metadata.json` ‚Üê **–î–û–î–ê–ù–û** |

### –¢–∏–ø–∏ —Ö–µ—à—ñ–≤, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è

- ‚úÖ **AUTOV2** - CivitAI AutoV2 Hash
- ‚úÖ **SHA256** - SHA256 Hash
- ‚úÖ **civitai** - CivitAI Legacy Hash
- ‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ —Ç–∏–ø–∏

## üéØ –í–∏–ø–∞–¥–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —à—É–∫–∞—î –º–æ–¥–µ–ª—å –∑ —Ö–µ—à–µ–º "abc123..."
‚Üí –û—Ç–∫—Ä—ã–≤–∞—î Inspector –Ω–∞ –º–æ–¥–µ–ª—ñ
‚Üí –ë–∞—á–∏—Ç—å hash: "abc123..." 
‚Üí –ó–Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω—É –º–æ–¥–µ–ª—å! ‚úÖ
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ
```
–ú–æ–¥–µ–ª—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞ –∑ Civitai
‚Üí Inspector –ø–æ–∫–∞–∑—É—î hash
‚Üí –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —â–æ –º–æ–¥–µ–ª—å –Ω–µ –ø–æ—à–∫–æ–¥–∂–µ–Ω–∞
```

### –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤–µ—Ä—Å—ñ—è–º–∏
```
–£ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —î –∫—ñ–ª—å–∫–∞ –≤–µ—Ä—Å—ñ–π –æ–¥–Ω—ñ—î—ó –º–æ–¥–µ–ª—ñ
‚Üí Inspector –ø–æ–∫–∞–∑—É—î —Ä—ñ–∑–Ω—ñ —Ö–µ—à—ñ –¥–ª—è –∫–æ–∂–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
‚Üí –õ–µ–≥–∫–æ —Ä–æ–∑—Ä—ñ–∑–Ω–∏—Ç–∏ –≤–µ—Ä—Å—ñ—ó
```

## üöÄ –ü–µ—Ä–µ–≤–∞–≥–∏

| –ê—Å–ø–µ–∫—Ç | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|--------|-----------|
| **–í–∏–¥–∏–º—ñ—Å—Ç—å** | ‚úÖ Hash –≤–∏–¥–Ω–æ –≤—ñ–¥—Ä–∞–∑—É –≤ Inspector |
| **–ü–æ—à—É–∫** | ‚úÖ –õ–µ–≥—à–µ –∑–Ω–∞–π—Ç–∏ –º–æ–¥–µ–ª—å –∑–∞ —Ö–µ—à–µ–º |
| **–ë–µ–∑–ø–µ–∫–∞** | ‚úÖ –ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å —Ñ–∞–π–ª—É |
| **–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è** | ‚úÖ –õ–µ–≥—à–µ –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –≤–µ—Ä—Å—ñ—ó –º–æ–¥–µ–ª–µ–π |
| **–°—É–º—ñ—Å–Ω—ñ—Å—Ç—å** | ‚úÖ –ë–µ–∑–∑–±—ñ–π–Ω–∞ - –º–∞—î fallback –Ω–∞ –ø–æ–º–∏–ª–∫–∏ |

## üîÑ –ü–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

1. **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–±–∏—Ä–∞—î –º–æ–¥–µ–ª—å –≤ Explorer**
2. **–ù–∞—Ç–∏—Å–∫–∞—î "Inspect"** 
3. **GUI –≤–∏–º–∞–≥–∞—î –º–µ—Ç–∞–¥–∞–Ω—ñ —á–µ—Ä–µ–∑ wrapper.py**
4. **wrapper.py –≤–∏–∫–ª–∏–∫–∞—î storage.get_metadata()**
5. **storage.get_metadata() –≤–∏–∫–æ–Ω—É—î:**
   - ‚úÖ –ß–∏—Ç–∞—î –º–µ—Ç–∞–¥–∞–Ω—ñ –∑ .safetensors —Ñ–∞–π–ª—É
   - ‚úÖ –á–¥–µ —à—É–∫–∞—î `.metadata.json` —Ñ–∞–π–ª —á–µ—Ä–µ–∑ model_metadata
   - ‚úÖ –î–æ–¥–∞—î hash –¥–æ –º–µ—Ç–∞–¥–∞–Ω–∏—Ö
6. **Inspector –ø–æ–∫–∞–∑—É—î –≤—Å—ñ –¥–∞–Ω—ñ –≤–∫–ª—é—á–Ω–æ –∑ hash**

## üíæ –°—Ö–æ–≤–∏—â–µ —Ö–µ—à—ñ–≤

–•–µ—à—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É —Ñ–∞–π–ª–∞—Ö:
```
my_model.safetensors                 ‚Üê –ú–æ–¥–µ–ª—å
my_model.safetensors.metadata.json   ‚Üê –ú–µ—Ç–∞–¥–∞–Ω—ñ –∑ —Ö–µ—à–µ–º
```

–ü—Ä–∏–∫–ª–∞–¥ `.metadata.json`:
```json
{
  "hash": "abc123def456ghi789jkl012mno345pqr678stu901",
  "hash_type": "AUTOV2",
  "civitai_model_id": "123456",
  "civitai_version_id": "789012",
  "last_updated": "2024-11-21T12:34:56"
}
```

## ‚úÖ –°—Ç–∞—Ç—É—Å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| Import model_metadata | ‚úÖ –î–æ–¥–∞–Ω–æ |
| get_metadata() –æ–Ω–æ–≤–ª–µ–Ω–Ω—è | ‚úÖ –í–∏–∫–æ–Ω–∞–Ω–æ |
| Error handling | ‚úÖ –î–æ–¥–∞–Ω–æ |
| –°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ | ‚úÖ Valid |

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä Inspector –ø–æ–∫–∞–∑—É—î **–ø–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é** –ø—Ä–æ –º–æ–¥–µ–ª—å –≤–∫–ª—é—á–Ω–æ –∑ hash, —â–æ –¥–æ–ø–æ–º–∞–≥–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º –ª–µ–≥—à–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ —Ç–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞—Ç–∏ –º–æ–¥–µ–ª—ñ!

---

**–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—è:** 21 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2024  
**–í–µ—Ä—Å—ñ—è:** 1.0.4  
**–°—Ç–∞—Ç—É—Å:** Production Ready ‚úÖ

